---
layout: page
title: マクロ平均・マイクロ平均・重み付き平均の違いとは？【DS検定】
permalink: /ds/average-methods-comparison/
tags: [ds, evaluation, statistics]
---

## まず結論

マクロ平均・マイクロ平均・重み付き平均とは、**分類モデルの評価指標をどのように平均するかの違い**です。  
DS検定では「不均衡データのとき、どの平均を使うと何が見えるか」を判断させる問題が出ます。

---

## 直感的な説明

クラスAが100件、クラスBが10件あるとします。

モデルがAばかり当てて、Bをほとんど当てられなかった場合、

- 全体では「よく当たっている」ように見える
- でもBだけ見ると「ほぼ失敗している」

このズレをどう扱うかが、平均手法の違いです。

---

## 定義・仕組み

分類では、クラスごとに再現率などを計算できます。  
その「クラスごとの値」をどうまとめるかがポイントです。

### マクロ平均

- 各クラスで指標を計算
- 単純に平均する
- クラス数で割るだけ

👉 データ数の多さは考慮しない

---

### マイクロ平均

- 全体をまとめて集計
- 正解数や誤分類数を合算してから計算

👉 件数の多いクラスの影響が大きい

---

### 重み付き平均

- 各クラスの指標に
- そのクラスのデータ数を掛けて平均

👉 クラス割合を反映する

---

## 実際の計算例（再現率で比較）

次のような2クラス分類を考えます。

|              | 予測A | 予測B |
|--------------|--------|--------|
| 実際A（100件） | 90 | 10 |
| 実際B（10件）  | 8  | 2  |

### ① 各クラスの再現率

- Aの再現率：90 / 100 = 0.9  
- Bの再現率：2 / 10 = 0.2  

👉 少数派Bはほとんど当てられていない

---

### ② マクロ平均

(0.9 + 0.2) ÷ 2 = 0.55

👉 少数派Bの低さがしっかり反映される

---

### ③ マイクロ平均

全体の正解数は  
90 + 2 = 92

全体のデータ数は  
110

92 ÷ 110 ≒ 0.836

👉 Aが多いため、高く見える

---

### ④ 重み付き平均

(0.9 × 100 + 0.2 × 10) ÷ 110  
= (90 + 2) ÷ 110  
= 0.836

👉 今回はマイクロ平均と同じ値になる

※ ただし、常に同じになるわけではありません。

---

## どんな場面で使う？

### マクロ平均

- 不均衡データ
- 少数クラスも重要な場合
- 医療・不正検知など

---

### マイクロ平均

- 全体性能を見たい場合
- データ量が多く、全体精度が重要な場合

---

### 重み付き平均

- 実際のクラス割合を反映した評価をしたい場合
- ビジネス上の出現頻度が重要な場合

---

## よくある誤解・混同

### ① 「精度が高い＝良いモデル」

不均衡データでは誤り。

DS検定では  
「精度が高いからバランスが良い」と書かれていたら注意。

---

### ② マクロ平均＝全体平均

違います。

選択肢で  
「全データをまとめて平均」とあれば、それはマイクロ平均。

---

### ③ 重み付き平均とマイクロ平均は常に同じ？

誤り。

2クラス・再現率では一致することがありますが、  
常に同じになるわけではありません。

---

## まとめ（試験直前用）

- マクロ平均：各クラスを平等に扱う  
- マイクロ平均：全体をまとめて評価  
- 重み付き平均：件数で調整  

不均衡データでは  
「どの平均か？」を必ず確認する。  

DS検定では  
評価方法の選び方が問われる。

---

【対応スキル項目（データサイエンス力シート）】
- データ理解
- モデル評価
- ★ モデルの評価指標を理解し、適切に解釈できる
