---
layout: page
title: Contrastive Loss（コントラスト損失）とは？【G検定対策】
permalink: /gk/contrastive-loss/
tags: [gk, neural_network, metrics]
gk_section: ディープラーニングの概要/誤差関数
gk_order: 1
---

## まず結論
- **Contrastive Loss（コントラスト損失）** とは、**類似したデータは近づけ、異なるデータは遠ざけるように学習させる損失関数**である。
- G検定では **分類精度との違い・距離学習という目的**がよく問われる。

## 直感的な説明
- 「似ているものは近くに、違うものは離して配置する」ルール。
- 例えば顔認識では  
  - 同じ人物の画像 → 近く  
  - 別人の画像 → 遠く  
- 正解ラベルそのものを当てるのではなく、  
  **データ同士の関係（距離）を学習する**のがポイント。

## 定義・仕組み
- Contrastive Loss は **埋め込み学習（Embedding Learning）** で使われる。
- データのペアに対して
  - 類似ペア：距離を小さく
  - 非類似ペア：距離を大きく
- 損失は **距離に基づいて計算**される。

👉 **分類精度を直接最大化する損失ではない**。

## いつ使う？（得意・不得意）
**得意**
- 顔認識
- 画像検索
- 類似文検索
- レコメンド

**不得意**
- 単純な多クラス分類
- 正解クラスを直接出したいタスク

## G検定ひっかけポイント
- ❌「分類精度を直接最大化する」
- ❌「ラベルだけを使い距離を考慮しない」
- ❌「ノイズデータを優先して学習する」

👉 **キーワードは「距離」「類似・非類似」「埋め込み」**

### 判断基準
- **距離を調整する損失 → Contrastive Loss**
- **正解クラス確率 → Cross Entropy**

## まとめ（試験直前用）
- 類似は近く、非類似は遠く
- 距離ベースの損失関数
- 埋め込み学習で使用
- 分類精度を直接扱わない
- 「距離」という言葉が出たら要注意
