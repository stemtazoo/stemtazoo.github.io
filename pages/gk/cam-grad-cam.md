---
layout: page
title: CAM と Grad-CAM（クラス活性化マップ）
permalink: /gk/cam-grad-cam/
tags: [gk, neural_network, cnn, xai]
---

## まず結論

* **CAM / Grad-CAM は CNN の判断根拠を可視化する手法**
* **「どこを見てそのクラスと判断したか」を示せる**
* **GAP を使うのが CAM、勾配を使うのが Grad-CAM**

---

## 直感的な説明

CAM / Grad-CAM は、

> **AIが「ここが重要だ」と見ていた場所をヒートマップで示す技術**

です。

「なぜこの画像を“犬”と判断したのか？」  
という問いに対して、

* 犬の顔？
* 耳？
* 体の輪郭？

など、**注目領域を可視化**できます。

---

## 定義・仕組み

### CAM（Class Activation Map）

* CNN の **最終畳み込み層 + GAP** を使用
* 各クラスに対応する特徴マップを
  **重み付き和** で可視化

👉 **構造に制約あり（GAP必須）**

---

### Grad-CAM（Gradient-weighted CAM）

* **勾配情報** を利用して重要度を算出
* GAP がなくても使える
* 多くの CNN に適用可能

👉 **汎用性が高い**

---

## CAM と Grad-CAM の違い（超重要）

| 項目 | CAM | Grad-CAM |
|---|---|---|
| 勾配の使用 | しない | **使う** |
| GAP必須 | **必須** | 不要 |
| 対応モデル | 限定的 | **幅広い** |
| 実用性 | 低め | **高い** |
| G検定頻度 | 中 | **高** |

---

## いつ使う？（得意・不得意）

### 得意なこと

* 画像分類モデルの説明
* 医療画像・監視・品質検査
* XAI（説明可能AI）の代表例

---

### 注意点・不得意

* 分類以外のタスクでは解釈が難しい場合がある
* 正解領域を保証するものではない

---

## GAP との関係（ここが狙われる）

### CAM の成立条件

* 最終畳み込み層
* **Global Average Pooling**
* 全結合層を使わない構造

👉  
**GAPを使っている → CAMが可能**

---

### Grad-CAM の立ち位置

* GAPに依存しない
* 既存モデルにも後付け可能

---

## G検定ひっかけポイント

### ❌ よくある誤解

* ❌ 「CAMはどんなCNNにも使える」
* ❌ 「Grad-CAMはGAPが必要」
* ❌ 「精度を向上させる手法」

---

### ✅ 正しい理解

* CAM / Grad-CAM は **可視化**
* **精度向上ではなく説明性向上**
* CAMは構造制約あり
* Grad-CAMは汎用

---

## 試験での即断キーワード

* 「判断根拠を可視化」
* 「どこを見たか」
* 「XAI」

👉 **CAM / Grad-CAM**

---

## まとめ（試験直前用）

* CAM：GAP必須・構造依存
* Grad-CAM：勾配利用・汎用
* 目的は **説明可能性**
* 精度向上ではない

👉 次は  
**CNN 出力層と XAI の関係まとめ**  
に進むと理解が完成します。
