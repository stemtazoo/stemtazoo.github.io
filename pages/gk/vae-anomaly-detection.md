---
layout: page
title: VAEを異常検知に使うと何が違う？AEとの比較【G検定対策】
permalink: /gk/vae-anomaly-detection/
tags: [gk, neural_network]
gk_section: ディープラーニングの要素技術/オートエンコーダ
gk_order: 4
---

## まず結論
- **AEは「再構成誤差」、VAEは「確率分布（尤度）」も使って異常を判断できる**点が大きな違い。
- G検定では「**VAEは確率モデルである**」ことを異常検知にどう活かすかが問われる。

## 直感的な説明
### AEによる異常検知
- 正常データをきれいに復元できる
- 異常データはうまく復元できない

👉 **どれだけズレたか（誤差）を見る**

### VAEによる異常検知
- 正常データが出やすい **分布** を学ぶ
- 異常データは「その分布から外れている」

👉 **そのデータがどれくらい“ありえないか”を見る**

AEは「形が違うか」、  
VAEは「確率的に不自然か」  
を見ているイメージです。

## 定義・仕組み
### AE（Autoencoder）
- 決定論的モデル
- 再構成誤差が小さい → 正常
- 再構成誤差が大きい → 異常
- 教師なし学習

### VAE（Variational Autoencoder）
- **確率モデル**
- 潜在変数を分布（平均・分散）で表現
- 以下を異常スコアとして使える：
  - 再構成誤差
  - データの尤度（確率の低さ）

重要：
- **VAEは「確率が低い＝異常」と判断できる**
- AEにはこの視点がない

## いつ使う？（得意・不得意）
### AEが向いているケース
- 異常検知をシンプルに行いたい
- 計算コストを抑えたい
- 再構成誤差で十分な場合

### VAEが向いているケース
- 正常データのばらつきが大きい
- 「正常っぽいが微妙に怪しい」ケースを扱いたい
- 確率的な解釈が欲しい

### 注意点
- VAEはAEより実装が複雑
- 再構成精度だけならAEが有利なこともある

## G検定ひっかけポイント
G検定では次の点で迷わせてきます。

### よくある誤解
- ❌「VAEはAEと同じ方法で異常検知する」
- ❌「VAEは異常検知に使えない」
- ❌「確率モデル＝分類器」

### 正しい判断基準
- **確率・分布・尤度 → VAE**
- **再構成誤差のみ → AE**
- **異常の“起こりにくさ”を見る → VAE**

問題文に  
「確率的」「分布から外れる」  
とあれば **VAEが正解候補**。

## まとめ（試験直前用）
- AE：再構成誤差で異常検知
- VAE：確率モデルとして異常検知
- VAEは「起こりにくさ」も評価できる
- AEはシンプル、VAEは柔軟
- 「確率・分布」→ VAE
