---
layout: page
title: グローバルアベレージプーリング（Global Average Pooling）
permalink: /gk/global-average-pooling/
tags: [gk, neural_network, cnn]
gk_section: ディープラーニングの要素技術/ネットワークの構成要素
gk_order: 7
---

## まず結論

* **GAPは全結合層の代わりに使われるプーリング手法**
* **特徴マップと出力クラスの対応関係を保てる**
* **パラメータ数削減＋解釈性向上** が目的

---

## 直感的な説明

グローバルアベレージプーリングは、

> **「この特徴マップは、どれくらい強く出ているか？」を1つの値で表す**

仕組みです。

通常のCNNでは最後に **全結合層（FC）** を使いますが、  
GAPでは

* 特徴マップごとに
* **画素全体の平均** を取って
* そのまま出力に使う

というシンプルな方法を取ります。

---

## 定義・仕組み

### GAPとは？

* 各特徴マップについて  
  **空間方向（縦×横）に平均を取る**
* 出力は  
  **「特徴マップ数＝クラス数」** になることが多い

---

### 全結合層との違い

| 項目 | 全結合層 | GAP |
|---|---|---|
| パラメータ数 | 多い | **少ない** |
| 過学習 | 起きやすい | **起きにくい** |
| 解釈性 | 低い | **高い** |
| 特徴と出力の対応 | 弱い | **強い** |

---

## なぜ解釈性が上がる？

* 各クラスが  
  **どの特徴マップに対応しているか明確**
* Class Activation Map（CAM）と相性が良い

👉  
「このクラスは、この特徴が効いている」  
と説明しやすくなります。

---

## いつ使う？（得意・不得意）

### 得意なこと

* 画像分類タスク
* モデルを軽量化したい場合
* 説明性（XAI）を重視する場合

（例：ResNet, GoogLeNet など）

---

### 注意点・不得意

* 空間的な細かい位置情報は使わない
* セグメンテーション用途には不向き

---

## G検定ひっかけポイント

### ❌ よくある誤解

* ❌ **「最大値プーリングと同じ」**
* ❌ **「単なるダウンサンプリング層」**
* ❌ **「全結合層と併用する」**

---

### ✅ 正しい理解

* ✅ **全結合層の代替**
* ✅ **平均を取るのは全体**
* ✅ **特徴マップと出力の対応が強い**

---

### 試験での即断キーワード

* 「全結合層の代わり」
* 「解釈性向上」
* 「パラメータ削減」

👉 **グローバルアベレージプーリング**

---

## 他のプーリングとの違い

| 手法 | 目的 |
|---|---|
| Max Pooling | 局所特徴抽出 |
| Average Pooling | 局所平均 |
| **Global Average Pooling** | **出力層用** |

---

## まとめ（試験直前用）

* GAP = **全体平均**
* 全結合層の代替
* 解釈性UP・軽量化
* CAMと相性が良い

👉 次は  
**CAM / Grad-CAM**  
との関係がよく問われます。
